{%- comment -%}
Feature Grid (2-col): left rail (2 stacked cards) + right main (big)
Defaults:
- Main = latest blog post
- Left #1 = random library track
- Left #2 = rotating (Live / Shop / Cat on the Signal)
Safe for Jekyll 3 (no where_exp comparisons).
{%- endcomment -%}

{%- assign recent = site.posts | first -%}
{%- assign random_track = site.data.library | shuffle | first -%}
{%- assign day_index = site.time | date: "%j" | plus: 0 -%}
{%- assign rot = day_index | modulo: 3 -%}

<section class="feature-grid">
  <!-- LEFT: stacked rail -->
  <div class="feature-rail">

    <!-- From the Library (small) -->
    <article class="feature-card feature-library"
      style="background-image:url('{{ random_track.image | default: "/assets/img/covers/default.webp" }}')">
      <div class="feature-overlay"></div>
      <div class="feature-body">
        <h3 class="eyebrow">From the Library</h3>
        {% if random_track %}
          <h2 class="headline"><a href="/tracks/{{ random_track.slug }}/">{{ random_track.title }}</a></h2>
          {% if random_track.mood %}<p class="sub">{{ random_track.mood | join: ", " }}</p>{% endif %}
          <a class="btn" href="/tracks/{{ random_track.slug }}/">Listen now</a>
        {% else %}
          <h2 class="headline">Dig the Archive</h2>
          <p class="sub">Browse 360+ tracks by mood, genre, and vibe.</p>
          <a class="btn" href="/library">Open Library</a>
        {% endif %}
      </div>
    </article>

    <!-- Rotating (small) -->
    {% case rot %}
      {% when 0 %}
        <article class="feature-card feature-live" style="background-image:url('/assets/img/hero/live-radio.webp')">
          <div class="feature-overlay"></div>
          <div class="feature-body">
            <h3 class="eyebrow">Live Radio</h3>
            <h2 class="headline"><a href="/live">Lo-Fi Signals, Live</a></h2>
            <p class="sub">Catch visual mixes, late-night loops, and ambient drift.</p>
            <a class="btn" href="/live">Tune in</a>
          </div>
        </article>
      {% when 1 %}
        <article class="feature-card feature-shop" style="background-image:url('/assets/img/hero/shop-hero.webp')">
          <div class="feature-overlay"></div>
          <div class="feature-body">
            <h3 class="eyebrow">Shop</h3>
            <h2 class="headline"><a href="/shop">Melting Boombox Drops</a></h2>
            <p class="sub">Prints, stickers, digital goodies — vibes you can hold.</p>
            <a class="btn" href="/shop">Browse drops</a>
          </div>
        </article>
      {% when 2 %}
        <article class="feature-card feature-cat" style="background-image:url('/assets/img/hero/cat-on-the-signal.webp')">
          <div class="feature-overlay"></div>
          <div class="feature-body">
            <h3 class="eyebrow">New Drop</h3>
            <h2 class="headline"><em>Cat on the Signal</em></h2>
            <p class="sub">Pastel glitchscapes + lo-fi bedroom pop.</p>
            <a class="btn" href="https://soundcloud.com/studiorich/cat-on-the-signal?si=12ab981478444d959fab3bb097f01c8e&utm_source=clipboard&utm_medium=text&utm_campaign=social_sharing" target="_blank" rel="noopener">Listen on SoundCloud</a>
          </div>
        </article>
    {% endcase %}

  </div>

  <!-- RIGHT: big main feature (latest post) -->
  <aside class="feature-main">
    <article class="feature-card feature-blog big"
      style="background-image:url('{{ recent.image | default: "/assets/img/hero/studio-rich-homepage-hero.webp" }}')">
      <div class="feature-overlay"></div>
      <div class="feature-body">
        <h3 class="eyebrow">Filed Under: Late Night Reads</h3>
        {% if recent %}
          <h2 class="headline"><a href="{{ recent.url }}">{{ recent.title }}</a></h2>
          {% if recent.description %}<p class="sub">{{ recent.description }}</p>{% endif %}
          <a class="btn" href="{{ recent.url }}">Read the story</a>
        {% else %}
          <h2 class="headline">Latest from the Blog</h2>
          <p class="sub">No posts yet — soon.</p>
        {% endif %}
      </div>
    </article>
  </aside>
</section>

{%- comment -%}
  Note: The feature grid is designed to be flexible and can be adjusted based on the content available.
  Ensure that the images used are optimized for web to maintain performance.
{%- endcomment -%}