{%- assign items = site.data.featured | default: empty -%}
{%- assign n     = include.count | default: items.size -%}
{%- assign cols  = include.cols  | default: 1 -%}
{%- assign size  = include.size  | default: 72 -%}
{%- assign collapsed = include.collapsed | default: true -%}

<aside class="feature-dock{{ collapsed | ternary: ' is-collapsed', '' }}"
       aria-label="{{ include.aria_label | default: 'Highlights' }}"
       style="--dock-cols: {{ cols }}; --notice-size: {{ size }}px;">
  <button class="dock-toggle" type="button" aria-expanded="{{ collapsed | ternary: 'false','true' }}">
    Highlights
  </button>

  <div class="dock-inner">
    {%- for f in items limit:n -%}
      <a class="notice-card"
         href="{{ f.href | relative_url }}"
         aria-label="{{ f.title | escape }}"
         style="--bg: url('{{ f.image | relative_url }}');">
        {%- if f.eyebrow %}<span class="notice-eyebrow">{{ f.eyebrow }}</span>{% endif -%}
        {%- if f.title   %}<span class="notice-title">{{ f.title }}</span>{% endif -%}
      </a>
    {%- endfor -%}

    {%- if include.show_blog and site.posts.size > 0 -%}
      {%- assign recent = site.posts | first -%}
      <a class="notice-card notice-card--blog"
         href="{{ recent.url | relative_url }}"
         aria-label="{{ recent.title | escape }}"
         style="--bg: url('{{ recent.image | default: "/assets/img/hero/studio-rich-homepage-hero.webp" | relative_url }}');">
        <span class="notice-eyebrow">Late Night Reads</span>
        <span class="notice-title">{{ recent.title }}</span>
      </a>
    {%- endif -%}
  </div>
</aside>

<script>
  // tiny inline toggler (scoped to this instance)
  (function(){
    const dock = document.currentScript.previousElementSibling; // <aside>
    const btn  = dock.querySelector('.dock-toggle');
    btn.addEventListener('click', () => {
      dock.classList.toggle('is-collapsed');
      btn.setAttribute('aria-expanded', dock.classList.contains('is-collapsed') ? 'false' : 'true');
    });
  })();
</script>
